---
// src/pages/noticias/[id].astro
import Layout from '../../layouts/Layout.astro';
import type { News } from '../../types/news';

export async function getStaticPaths() {
  // Obtener todos los datos de la hoja "Noticias"
  const response = await fetch('https://sheetdb.io/api/v1/vojw2fwtn94j3?sheet=Noticias');

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  const data = await response.json();

  return data.map((news: News) => ({
    params: { id: news.ID_Noticia }, // Usar el campo ID_Noticia como identificador
    props: { news },
  }));
}

const { news } = Astro.props;
const { Titulo, Contenido, image_url, Autor, Fecha_Publicacion } = news;

// Función para formatear fechas
const formatDate = (dateString: string) => {
  return new Date(dateString).toLocaleDateString('es-ES', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};
---

<Layout title={`FUC - ${Titulo}`}>
  <div class="max-w-4xl mx-auto px-4 py-12">
    <a 
      href="/noticias" 
      class="inline-flex items-center text-red-600 hover:text-red-700 mb-8"
    >
      ← Volver a Noticias
    </a>

    <article>
      <h1 class="text-4xl font-bold mb-6">{Titulo}</h1>

      <div class="flex items-center gap-4 text-gray-600 mb-8">
        <span>{Autor}</span>
        <span>•</span>
        <span>{formatDate(Fecha_Publicacion)}</span>
      </div>

      <img 
        src={image_url || '/placeholder-news.jpg'}
        alt={Titulo}
        class="w-full h-[400px] object-cover rounded-lg mb-8"
      />

      <div class="prose prose-lg max-w-none">
        {Contenido}
      </div>
    </article>
  </div>
</Layout>